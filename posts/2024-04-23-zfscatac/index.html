















<!DOCTYPE html>
<html lang='en-gb'><head>
    <meta charset="utf-8">
    <link rel="shortcut icon" href='https://dbrg77.github.io/lab-website/favicon.ico' type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>The chromatin states during Zebrafish embryogenesis - Xi Chen Lab @ SUSTech</title>

    

    

    

    
        <meta property="og:title" content="The chromatin states during Zebrafish embryogenesis" />
<meta property="og:description" content="Some background information about our zebrafish scATAC-seq paper" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://dbrg77.github.io/lab-website/posts/2024-04-23-zfscatac/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2024-04-23T00:55:37+01:00" />
<meta property="article:modified_time" content="2024-04-23T00:55:37+01:00" />


    

    
        <meta name="twitter:card" content="summary"/><meta name="twitter:title" content="The chromatin states during Zebrafish embryogenesis"/>
<meta name="twitter:description" content="Some background information about our zebrafish scATAC-seq paper"/>

    <link rel="stylesheet" href="https://dbrg77.github.io/lab-website/style.min.9453882848761212fd0662479c32592fbcb9a4b6dab13abcb5a420f87860ea242803f514d4b17c10147e7a9bc0cd6df27820f1ad1a7827607324ef137e8d8b8f.css" integrity="sha512-lFOIKEh2EhL9BmJHnDJZL7y5pLbasTq8taQg&#43;Hhg6iQoA/UU1LF8EBR&#43;epvAzW3yeCDxrRp4J2BzJO8Tfo2Ljw==">





    
    <script>
        if (!('theme' in localStorage)) {
            localStorage.theme = 'light';
        }

        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.setAttribute("data-theme", "dark");
        } else {
            document.documentElement.setAttribute("data-theme", "light");
        }
    </script>
<script defer src="https://dbrg77.github.io/lab-website/js/header.ef6a12cbb6ff661b899d830d9eb30134ede25fc9c26aaddecec6089c686d2e45a0bf73fa531eb2aba666bfa46699790ecc7cfee38ebc17a00ccaeffd2155eea0.js" integrity="sha512-72oSy7b/ZhuJnYMNnrMBNO3iX8nCaq3ezsYInGhtLkWgv3P6Ux6yq6Zmv6RmmXkOzHz&#43;4468F6AMyu/9IVXuoA=="></script>



    <script defer src="https://dbrg77.github.io/lab-website/js/zooming.684b5d075bf94d0adfa21a7e7eb9acec1ddfb2e7b47d6657981617f0db0cf50949f1172801595afa3051f51b28d67f6a2d0c41be677b59b564307d9dbe4a4fd2.js" integrity="sha512-aEtdB1v5TQrfohp&#43;frms7B3fsue0fWZXmBYX8NsM9QlJ8RcoAVla&#43;jBR9Rso1n9qLQxBvmd7WbVkMH2dvkpP0g=="></script>




    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script defer src="https://dbrg77.github.io/lab-website/js/math.d7efde37b2eb8879651e1f4489bcd4d8203b8c2bf8ca12c9e1b8cd11bfd6395b172f4999fff43ce0d047889a2bdb71ee74aebbae5327590192d1144e790fcd7b.js" integrity="sha512-1&#43;/eN7LriHllHh9EibzU2CA7jCv4yhLJ4bjNEb/WOVsXL0mZ//Q84NBHiJor23HudK67rlMnWQGS0RROeQ/New=="></script>









<link rel="stylesheet" href="https://dbrg77.github.io/lab-website/user.css">
</head>
<body>
        <main><header>
    <div class="brand">
        <div id="sidebar_btn">
            <svg id="menu_icon" width="26px" height="26px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line>
</svg>

</svg>
        </div>

        <div>
            <a href="https://dbrg77.github.io/lab-website/">Xi Chen Lab @ SUSTech</a>
        </div>
    </div>

    <div class="toolbox">
        <div id="theme_tool">
            <svg id="dark_mode_btn" class="toolbox-btn" width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
</svg>

</svg>
            <svg id="light_mode_btn" class="toolbox-btn" width="18px" height="18px" viewBox="0 0 24 24">
<svg
    xmlns="http://www.w3.org/2000/svg"
    width="24" height="24" viewBox="0 0 24 24" fill="none"
    stroke="currentColor" stroke-width="2" stroke-linecap="round"
    stroke-linejoin="round">
    <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
</svg>

</svg>
        </div>

        

        
    </div>
</header>
<nav id="navbar" class="pure-menu">
    <ul class="pure-menu-list"><li class="navbar-item pure-menu-item ">
                    
                        <a href="https://dbrg77.github.io/lab-website/" class="pure-menu-link">Home</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="https://dbrg77.github.io/lab-website/research/" class="pure-menu-link">Research</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="https://dbrg77.github.io/lab-website/teaching/" class="pure-menu-link">Teaching</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="https://dbrg77.github.io/lab-website/members/" class="pure-menu-link">Members</a>
                    
                </li><li class="navbar-item pure-menu-item insection">
                    
                        <a href="https://dbrg77.github.io/lab-website/posts/" class="pure-menu-link">BehindThePaper</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="https://dbrg77.github.io/lab-website/publications/" class="pure-menu-link">Publications</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="https://dbrg77.github.io/lab-website/resource/" class="pure-menu-link">Resource</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="https://dbrg77.github.io/lab-website/news/" class="pure-menu-link">News &amp; Photos</a>
                    
                </li><li class="navbar-item pure-menu-item ">
                    
                        <a href="https://dbrg77.github.io/lab-website/joinus/" class="pure-menu-link">Join Us</a>
                    
                </li></ul>
</nav>
<div id="sidebar_canvas_overlay" class="hidden"></div>
<div id="sidebar" class="close">
    <ul><li>
                    <a href="https://dbrg77.github.io/lab-website/">Home</a>
                </li><li>
                    <a href="https://dbrg77.github.io/lab-website/research/">Research</a>
                </li><li>
                    <a href="https://dbrg77.github.io/lab-website/teaching/">Teaching</a>
                </li><li>
                    <a href="https://dbrg77.github.io/lab-website/members/">Members</a>
                </li><li>
                    <a href="https://dbrg77.github.io/lab-website/posts/">BehindThePaper</a>
                </li><li>
                    <a href="https://dbrg77.github.io/lab-website/publications/">Publications</a>
                </li><li>
                    <a href="https://dbrg77.github.io/lab-website/resource/">Resource</a>
                </li><li>
                    <a href="https://dbrg77.github.io/lab-website/news/">News &amp; Photos</a>
                </li><li>
                    <a href="https://dbrg77.github.io/lab-website/joinus/">Join Us</a>
                </li></ul>
</div><div id="content" class="content-margin">
                


    <div class="content-margin">



<article class="line-numbers">
    
    
    <p>One fundamental question in developmental biology is how a totipotent cell develops into all kinds of different cell types in an organism. During early embryogenesis, there is often a cleavage stage when cells just go through a series of synchronised and rapid cell cycles to produce many cells. At the very early stages, say the 4-cell stage, cells within an embryo are generally thought to be the same and all of them are still totipotent. Intuitively, the cells have to decide what cell types they need to become at some point along the development procedures. Then a question follows naturally: <em>when is the first time that a cell decides to take a specific fate?</em> That might be a question too big or too broad to address directly, and we may also end up in a rabbit hole debating on what exactly <strong>cell fate decision</strong> is. The more approachable questions that we could actually investigated are: <em>when cells become different from one another and what are the differences?</em></p>
<p>This is something that needs to be addressed by single-cell methods. We used zebrafish as our model system. Of note, we are not the only people that have thought about this. In 2018, <a href="https://doi.org/10.1126/science.aar3131">Farrell, Wang <em>et al.</em></a> from the Regev and the Schier labs used <strong>Drop-seq</strong> and <a href="https://doi.org/10.1126/science.aar4362">Wagner <em>et al.</em></a> from the Megason and the Klein labs used <strong>inDrop</strong> to profile the transcriptomes of over tens of thousands of cells of zebrafish. They generated comprehensive cell atlases of zebrafish early embryogenesis. The atlases covered key developmental stages from 3.3 hours post fertilisation (hpf) up to 24 hpf. They identified key developmental time points when new cell types emerge and the gene expression programs associated with each cell type. In those atlases, the vast majority of the data are after the dome stage (~4.3 hpf). This makes sense since the zebrafish genome remains silent before zygotic genome activation (ZGA) that happens around 3 hpf. The development of embryos are mainly supported by maternal material during those cleavage stages. Therefore, it is only meaningful to investigate the transcriptomes after ZGA.</p>
<p>However, another important layer of regulation of the development and cell fate decision is the chromatin status. Many studies have shown that the chromatin undergoes dramatic changes throughout the entire embryogenesis, including those pre-ZGA stages. Routine observations on embryos suggest that cells already become morphologically different and asynchronised around ZGA. Therefore, an intuitive question to ask is: <em>when do cells become different from one another for the first time at the chromatin level?</em> More importantly, do those differences contribute to the cell fate decisions during later development? To this end, maybe it is worthwhile to re-investigate the early embryogenesis using single-cell ATAC-seq, focusing on key time points immediately after ZGA. That was the idea Ni, Wenfei and I came up with on the return trip from a BGI single-cell meeting back in June 2019, many months before the pandemic.</p>
<p>That was one of the first projects that I committed to after coming back to China and join SUSTech. I still vividly remember the scene where we sat in the taxi cab discussing various aspects on zebrafish and medaka that Ni used to work on. After solving some practical problems, the project started. The initial goal was very clear: just use our plate-based single-cell ATAC-seq method to profile zebrafish embryonic cells from 3 hpf (1k) to 4.3 hpf (dome).</p>
<p>As always, it turned out that the project was not going as smoothly as we wanted. The first problem was that the new students had never worked on any single-cell genomic methods. We constantly failed library preparation. Instead of seeing the nice nucleosome phasing pattern of the library on DNA gels, we saw nothing for the first few months. Then we figured out the problem was incorrectly treating the oil droplets from the yolk as cells. Of course we got no libraries from those, because the cells were just not there. Then we had another problem with FACS. After tagmentation, single nuclei needed to be sorted into each individual well in 384-well plates. Again, that was challenging for students who had never done sorting themselves. The first few trials were all look like the picture on the left shown below. The colour indicates the log10 number of reads recovered from each well. After a quite a lot of practice, the problem was finally solved, which looked like the picture shown on the right below. The progress was nice.</p>
<p><img src="./facs_examples.png" alt=""></p>
<p>The next problem was related to data analysis. Due to the limited number of cells per embryo at the early stages and the short time periods between stages, it was not practical to collect all experiments from all time points in one go. We have to do one time point on one day. In this case, we created batch effects and the experimental workflow was confounded, because each time point was also a batch. Data visualisation without any batch corrections looked like this:</p>
<figure><img src="./batch_effect.png" width="500px"/>
</figure>

<p>which was totally expected. Apparently, we needed to perform some sort of batch correction to make cells from the same stage mixed together in the UMAP. To be honest, I do not think this &ldquo;batch removed&rdquo; UMAP actually gives us new insights, but it is what people normally do. Now that I think about it, since we know what to expect, we should try some semi-supervised methods, but that would be another separate post on its own (stay tuned!). Anyway, to remove the batch effect, we could just use the routine and integrate all of them together:</p>
<figure><img src="./over_correct.png" width="500px"/>
</figure>

<p>which resulted in a UMAP that was difficult to interpret, because the time information was not obvious and the two methods gave different information. After many trials with different settings and different methods, we eventually went with default settings of <a href="https://doi.org/10.1093/bioinformatics/btz625">BBKNN</a>:</p>
<figure><img src="./bbknn.png" width="500px"/>
</figure>

<p>which gave the best result. Why do I say BBKNN gives the best result? Well &hellip; it is not really based on some metrics. It is purely based on our expectation. Therefore, I cannot say the current UMAP is the ground truth, but it is a nice visualisation. Anyway, the rest of the analysis was basically described in <a href="https://doi.org/10.1093/nar/gkae095">our paper</a>.</p>
<p>During the execution of the project, there were many difficulties. The project was new; the lab was new; we needed to get used to the equipment and environment <em>etc.</em> The most difficult thing for me was the many nights of self-doubt. The situation was that we knew this was a competitive field and we might get scooped. We were moving forward very slowly, which did not help. However, for a very long time, there was no paper about this. That was good, but at the same time, it also made us think that we might not be on the right track. Were these questions interesting and important? Were they worth investigating? Did people really care? Why other people haven&rsquo;t done that? Were we missing something?</p>
<p>Those were the questions kept haunting me during the past few years, but I&rsquo;m glad we did it now. Congratulations to all co-authors. We made it!!</p>

</article>
</div>


                
                    
                
            </div>
<footer>
    <article>Xi Chen Lab @ SUSTech, 2024</article>
</footer>

</main>
    </body>
</html>
